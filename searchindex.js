Search.setIndex({"docnames": ["chapter_auto_program_optimization/index", "chapter_end_to_end/e2e-assignment", "chapter_end_to_end/index", "chapter_gpu_acceleration/index", "chapter_gpu_acceleration/part1", "chapter_gpu_acceleration/part2", "chapter_integration/index", "chapter_introduction/index", "chapter_tensor_program/case_study", "chapter_tensor_program/index", "chapter_tensor_program/tensor_program", "chapter_tensor_program/tensorir_exercises", "index"], "filenames": ["chapter_auto_program_optimization/index.rst", "chapter_end_to_end/e2e-assignment.rst", "chapter_end_to_end/index.rst", "chapter_gpu_acceleration/index.rst", "chapter_gpu_acceleration/part1.rst", "chapter_gpu_acceleration/part2.rst", "chapter_integration/index.rst", "chapter_introduction/index.rst", "chapter_tensor_program/case_study.rst", "chapter_tensor_program/index.rst", "chapter_tensor_program/tensor_program.rst", "chapter_tensor_program/tensorir_exercises.rst", "index.rst"], "titles": ["<span class=\"section-number\">4. </span>Automatic Program Optimization", "MLC Assignment 1: End-to-End Model Execution", "<span class=\"section-number\">3. </span>End to End Model Execution", "<span class=\"section-number\">6. </span>GPU and Hardware Acceleration", "<span class=\"section-number\">6.1.1. </span>Part 1", "<span class=\"section-number\">6.1.9. </span>Part 2", "<span class=\"section-number\">5. </span>Integration with Machine Learning Frameworks", "<span class=\"section-number\">1. </span>Introduction", "<span class=\"section-number\">2.4. </span>TensorIR: Tensor Program Abstraction Case Study", "<span class=\"section-number\">2. </span>Tensor Program Abstraction", "<span class=\"section-number\">2.1. </span>Primitive Tensor Function", "<span class=\"section-number\">2.5. </span>Exercises for TensorIR", "Machine Learning Compilation"], "terms": {"In": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12], "past": [0, 4, 5, 6, 8], "chapter": [0, 2, 4, 5, 6, 8, 9], "we": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "learn": [0, 1, 2, 3, 5, 7, 9, 10, 11], "about": [0, 1, 2, 5, 6, 7, 8, 10], "how": [0, 1, 2, 4, 5, 6, 7, 8, 9], "build": [0, 1, 3, 5, 7, 9, 12], "connect": [0, 1, 2, 6, 7], "them": [0, 1, 2, 4, 6, 7, 8], "form": [0, 2, 5, 6, 7, 8, 10, 12], "There": [0, 2, 6, 7, 8], "ar": [0, 2, 4, 5, 6, 7, 8, 10, 11], "three": [0, 4, 8, 11], "primari": [0, 8], "type": [0, 2, 6, 8, 10], "abstract": [0, 1, 2, 6, 11, 12], "have": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11], "us": [0, 2, 3, 4, 5, 7, 10, 11], "so": [0, 2, 3, 4, 5, 6, 8, 10], "far": [0, 2, 4, 5, 6, 8], "A": [0, 1, 2, 3, 4, 6, 7, 8, 10, 11], "comput": [0, 1, 3, 4, 6, 7, 9, 10, 11], "graph": [0, 1, 6, 7], "view": [0, 4, 6, 7, 8, 10], "drive": [0, 7, 10], "high": [0, 2, 7, 8, 11, 12], "level": [0, 1, 2, 4, 5, 7, 8, 10, 11, 12], "librari": [0, 6, 7, 8, 10, 12], "call": [0, 1, 2, 4, 5, 6, 7, 8, 10], "via": [0, 1, 2, 6], "environ": [0, 3, 4, 5, 7, 8, 10, 12], "registr": [0, 2], "all": [0, 1, 2, 4, 5, 6, 7, 8, 10], "element": [0, 2, 3, 4, 6, 8, 10, 12], "encapsul": [0, 8], "an": [0, 1, 3, 4, 5, 7, 8, 10, 11, 12], "irmodul": [0, 1, 4, 5, 8, 11, 12], "most": [0, 2, 5, 6, 7, 8, 10], "mlc": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12], "process": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "can": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "among": [0, 2, 6, 8, 10], "mani": [0, 2, 4, 5, 6, 7, 8, 10], "differ": [0, 2, 4, 5, 6, 7, 8, 10, 11, 12], "wai": [0, 1, 2, 4, 5, 6, 7, 9], "same": [0, 2, 4, 7, 8, 10, 11], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "autom": [0, 7, 8], "some": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11], "To": [0, 1, 2, 4, 5, 6, 8], "begin": [0, 1, 2, 4, 5, 6, 7, 8], "import": [0, 1, 2, 4, 5, 7, 8, 10, 11, 12], "necessari": [0, 1, 2, 4, 5, 6, 7, 8, 10], "depend": [0, 2, 3, 4, 5, 6, 7, 10, 12], "creat": [0, 1, 2, 3, 4, 9], "helper": [0, 2, 6, 8], "i": [0, 1, 2, 3, 4, 5, 6, 8, 10, 11, 12], "need": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "defer": [0, 2, 4, 5, 6], "annot": [0, 2, 4, 5, 6, 8, 10], "pars": [0, 2, 4, 5, 6], "tvmscript": [0, 1, 4, 5, 6, 12], "from": [0, 2, 4, 5, 7, 8, 10, 11, 12], "__future__": [0, 2, 4, 5, 6], "numpi": [0, 1, 2, 4, 5, 6, 8, 10, 11], "np": [0, 1, 2, 4, 5, 6, 8, 11], "tvm": [0, 1, 2, 3, 4, 5, 6, 8, 11], "relax": [0, 1, 2, 4, 5, 6], "ir": [0, 2, 4, 5, 6, 8, 11], "modul": [0, 2, 4, 5, 6, 8, 11], "script": [0, 1, 2, 4, 5, 6, 8, 11], "r": [0, 1, 2, 4, 5, 6], "tir": [0, 1, 2, 4, 5, 6, 8, 11], "t": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "ipython": [0, 1, 2, 8, 11], "def": [0, 1, 2, 4, 5, 6, 8, 11], "code2html": 0, "code": [0, 1, 3, 6, 7, 10, 11, 12], "pygment": 0, "turn": [0, 1, 2, 8], "string": [0, 2], "highlight": [0, 8], "html": 0, "formatt": 0, "htmlformatt": 0, "lexer": 0, "python3lex": 0, "return": [0, 1, 2, 4, 5, 6, 8], "style": [0, 2], "": [0, 1, 2, 4, 6, 7, 8, 11], "n": [0, 1, 6, 11], "get_style_def": 0, "let": [0, 1, 2, 4, 5, 6, 7, 8, 11], "u": [0, 1, 2, 4, 5, 6, 7, 8, 10], "review": [0, 2, 4, 6, 7, 8], "what": [0, 1, 2, 4, 8, 11, 12], "did": [0, 4, 6], "our": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11, 12], "previou": [0, 2, 7], "singl": [0, 1, 5, 6, 7, 8, 9, 10], "ir_modul": [0, 1, 2, 4, 5, 6, 8, 11], "class": [0, 1, 2, 4, 5, 6, 7, 8, 11], "mymodul": [0, 2, 6, 8], "prim_func": [0, 1, 2, 4, 5, 6, 8, 11], "main": [0, 1, 2, 4, 5, 6, 8], "buffer": [0, 1, 2, 4, 5, 6, 10, 11], "128": [0, 1, 2, 4, 6, 8, 10, 11], "float32": [0, 1, 2, 4, 5, 6, 8, 11], "b": [0, 1, 2, 4, 5, 6, 8, 11], "c": [0, 1, 2, 4, 5, 6, 8, 10, 11], "func_attr": [0, 1, 2, 4, 5, 6, 8, 11], "global_symbol": [0, 1, 2, 4, 5, 6, 8, 11], "noalia": [0, 1, 2, 4, 5, 6, 8, 11], "true": [0, 1, 2, 4, 5, 6, 8, 11], "j": [0, 1, 2, 4, 5, 6, 8, 11], "k": [0, 2, 4, 5, 6, 8, 11], "grid": [0, 1, 2, 4, 5, 6, 8, 11], "block": [0, 1, 3, 11], "vi": [0, 1, 2, 4, 5, 8, 10, 11], "vj": [0, 1, 2, 4, 5, 8, 11], "vk": [0, 2, 4, 5, 8], "axi": [0, 1, 2, 4, 5, 6, 10, 11], "remap": [0, 1, 2, 4, 5, 6, 8, 11], "ssr": [0, 2, 4, 5, 6, 8], "init": [0, 2, 4, 5, 6, 8, 11], "0": [0, 1, 2, 4, 5, 6, 8, 10, 11], "first": [0, 1, 4, 5, 6, 7, 8, 11, 12], "defin": [0, 1, 2, 5, 6, 7, 8], "set": [0, 1, 2, 4, 5, 7, 8, 10], "input": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "output": [0, 1, 2, 5, 6, 7, 8], "evalu": [0, 3, 4, 5], "dtype": [0, 1, 2, 4, 5, 6, 8, 11], "a_np": [0, 4, 5, 8], "random": [0, 4, 5, 8, 11], "rand": [0, 5, 8, 11], "astyp": [0, 4, 5, 8, 11], "b_np": [0, 4, 5, 8], "c_mm": 0, "run": [0, 3, 5, 6, 7, 9, 11, 12], "follow": [0, 1, 2, 3, 4, 5, 6, 8, 10, 11], "a_nd": [0, 4, 5, 8], "nd": [0, 1, 2, 4, 5, 6, 8, 11], "arrai": [0, 1, 2, 4, 5, 6, 7, 8, 11], "b_nd": [0, 4, 5, 8], "c_nd": [0, 4, 5, 8], "empti": [0, 1, 2, 5, 8, 11], "lib": [0, 5], "target": [0, 1, 2, 4, 5, 6, 8, 11], "llvm": [0, 1, 2, 5, 6, 8, 11], "f_timer_befor": [0, 8], "time_evalu": [0, 4, 8, 11], "cpu": [0, 1, 2, 4, 5, 6, 8, 11], "print": [0, 1, 2, 4, 6, 8, 11], "time": [0, 1, 2, 4, 5, 8, 11], "cost": [0, 7, 8], "3f": 0, "m": [0, 1, 3, 4, 6, 8], "mean": [0, 2, 4, 8], "1000": 0, "2": [0, 2, 3, 4, 6, 9], "573": 0, "next": [0, 2, 6, 8], "bit": [0, 2], "reorgan": [0, 5], "loop": [0, 1, 2, 3, 4, 7, 10, 11], "access": [0, 1, 4, 5, 8, 11], "pattern": 0, "schedule_mm": 0, "sch": [0, 1, 4, 5, 8, 11], "jfactor": [0, 8], "4": [0, 4, 5, 8, 10, 11], "block_c": [0, 4, 8], "get_block": [0, 1, 4, 5, 8, 11], "get_loop": [0, 1, 4, 5, 8, 11], "j_0": [0, 4, 5, 8], "j_1": [0, 4, 5, 8], "split": [0, 1, 4, 5, 6, 8, 10, 11], "factor": [0, 4, 5, 8, 11], "none": [0, 1, 2, 4, 5, 6, 8, 11], "reorder": [0, 2, 4, 5, 8, 10, 11], "decompose_reduct": [0, 4, 5, 8, 11], "displai": [0, 1, 2, 8, 11], "mod": [0, 1, 4, 5, 8, 11], "quot": [0, 2, 8, 11], "gt": [0, 2, 8, 11], "attr": [0, 2, 4, 5, 6, 8, 11], "dict": [0, 2, 4, 5, 6, 8, 11], "bodi": [0, 1, 2, 4, 5, 6, 8, 11], "root": [0, 1, 2, 4, 5, 6, 8, 11], "32": [0, 1, 8, 11], "j_1_init": 0, "serial": [0, 4, 5, 6, 8, 11], "c_init": [0, 4], "spatial": [0, 1, 4, 5, 6, 8, 10, 11], "read": [0, 1, 2, 4, 5, 6, 8, 11], "write": [0, 1, 2, 4, 5, 6, 8, 9], "c_updat": [0, 4], "reduc": [0, 1, 4, 5, 7, 8, 11, 12], "Then": [0, 1, 2, 4, 5, 6, 8, 11], "re": [0, 2, 4, 8], "organ": [0, 1, 11], "f_timer_aft": [0, 8], "146": 0, "besid": 0, "field": [0, 6, 7, 12], "anoth": [0, 1, 2, 4, 6, 7], "offer": [0, 7, 10, 12], "show": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "step": [0, 1, 2, 5, 6, 7, 8, 9, 10, 11], "involv": [0, 2, 7, 8, 10, 12], "get": [0, 1, 2, 4, 6, 7, 10, 11], "out": [0, 1, 2, 4, 6, 7, 8, 10, 11], "b0": [0, 1, 2, 6], "name": [0, 1, 2, 6, 8], "func_nam": [0, 1, 8, 11], "l1": 0, "l2": 0, "l3": 0, "l4": 0, "l5": 0, "preserve_unit_it": 0, "b6": 0, "The": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "abov": [0, 1, 2, 5, 6, 7, 8, 10], "align": 0, "specifi": [0, 6, 7, 8], "One": [0, 2, 5, 6, 7, 8, 10], "note": [0, 1, 2, 3, 5, 6, 8, 11, 12], "plu": 0, "origin": [0, 1, 8, 11], "give": [0, 2, 6, 7, 11], "complet": [0, 11], "deriv": 0, "final": [0, 2, 4, 6, 7, 8, 10, 11], "keep": [0, 2, 4, 6, 7, 8], "mind": [0, 2, 8], "throughout": 0, "inspect": [0, 4, 8], "up": [0, 1, 2, 5, 6, 7, 8], "until": [0, 8], "now": [0, 1, 2, 4, 5, 6, 7, 8, 11], "everi": [0, 1, 2, 6], "detail": [0, 2, 5, 7, 8], "want": [0, 2, 6, 7, 8, 11], "make": [0, 1, 7, 8, 11], "tensorir": [0, 1, 3, 9, 12], "those": [0, 6, 7, 8], "choic": [0, 7, 8, 12], "base": [0, 8, 10], "understand": [0, 5, 7, 8, 11], "underli": [0, 2], "cach": [0, 4, 8], "hardwar": [0, 1, 4, 7, 8, 11, 12], "unit": [0, 5, 8, 9, 10], "howev": [0, 1, 4, 6, 7], "practic": [0, 2, 4, 7, 8, 10], "mai": [0, 1, 2, 7, 11], "abl": [0, 2, 6, 8, 10], "decid": 0, "accur": 0, "instead": [0, 1, 2, 6, 8], "do": [0, 1, 2, 5, 6, 7, 8, 10, 11], "would": [0, 2, 7, 8], "like": [0, 1, 2, 4, 7, 8], "possibl": [0, 2, 5, 7, 8, 9, 10], "while": [0, 1, 2, 5, 7, 8], "leav": [0, 7], "natur": [0, 2, 7, 8], "achiev": 0, "goal": [0, 2, 6, 7, 8, 12], "add": [0, 1, 2, 4, 5, 6, 7, 10], "doe": [0, 1, 2, 3, 4, 6, 7], "stochastic_schedule_mm": 0, "j_factor": [0, 8], "sample_perfect_til": 0, "compar": [0, 1, 8, 11], "side": [0, 2, 6, 7, 8, 10], "find": [0, 1, 2, 5, 6, 7, 8], "onli": [0, 1, 2, 4, 6, 7, 8, 11], "case": [0, 2, 4, 5, 6, 7, 9, 10, 11, 12], "pass": [0, 1, 2, 6, 8, 11], "paramet": [0, 4, 6, 12], "come": [0, 2, 5, 7, 8, 10, 11, 12], "As": [0, 1, 2, 5, 6, 7, 8], "suggest": 0, "tri": 0, "draw": 0, "number": [0, 4, 7], "fill": 0, "It": [0, 1, 2, 6, 7, 8, 11], "sampl": 0, "thei": [0, 4, 5, 6, 7, 8], "perfectli": 0, "For": [0, 2, 3, 6, 7, 10], "exampl": [0, 1, 2, 3, 7, 8, 10, 12], "when": [0, 1, 2, 6, 7, 8, 10], "size": [0, 4, 7, 8], "includ": [0, 1, 2, 7, 8, 10], "8": [0, 1, 2, 4, 8, 11], "16": [0, 4, 5, 8, 11], "64": [0, 4, 5], "try": [0, 2, 4, 6, 8, 11], "see": [0, 1, 2, 7, 8, 11], "effect": [0, 2, 5, 7, 8, 10], "multipl": [0, 1, 2, 3, 5, 6, 7, 8], "observ": [0, 5, 7, 8], "outcom": 0, "you": [0, 1, 2, 8, 11], "might": [0, 2, 7, 8], "bound": [0, 8], "chang": [0, 2, 4, 8, 10], "each": [0, 1, 2, 4, 6, 7, 8, 10], "happen": [0, 5, 7, 8], "here": [0, 1, 2, 4, 5, 6, 7, 8, 11, 12], "randomli": [0, 8], "latest": [0, 5, 7], "one": [0, 1, 2, 4, 5, 6, 7, 9, 11], "decis": [0, 2], "made": 0, "v4": 0, "v5": 0, "max_innermost_factor": 0, "l6": 0, "l7": 0, "b8": 0, "look": [0, 4, 5, 8], "pai": 0, "close": [0, 7, 8], "attent": 0, "part": [0, 2, 3, 6, 7, 8, 10], "correspond": [0, 1, 2, 4, 5, 6, 7, 8, 10], "valu": [0, 2, 4, 6, 7, 8, 11], "sampling_perfect_til": 0, "pick": [0, 7, 11], "last": [0, 2, 8, 10], "altern": [0, 1, 5, 6], "take": [0, 2, 4, 5, 6, 7, 8, 10, 11], "deeper": [0, 7], "simpl": [0, 1, 2, 4, 6, 11], "gener": [0, 1, 2, 4, 5, 6, 7], "determinist": 0, "two": [0, 2, 4, 5, 6, 7, 8, 11], "addit": [0, 5, 7, 8, 10], "variabl": [0, 1, 6, 8, 10], "other": [0, 2, 3, 6, 7, 8], "oper": [0, 1, 2, 5, 7, 8, 10, 11, 12], "cover": [0, 2, 5, 7, 8], "action": [0, 2], "expr": [0, 6], "var": [0, 1, 5, 6], "real": [0, 2, 5, 7, 8, 12], "integ": 0, "symbol": 0, "refer": [0, 2, 6, 7, 8, 10, 12], "being": [0, 1, 2, 6, 7, 8], "api": [0, 1, 2, 7, 8], "track": [0, 6], "If": [0, 2, 5, 7, 8, 11], "current": [0, 8, 11], "point": [0, 5, 8], "remain": [0, 5, 7, 8], "sinc": [0, 2, 7], "yet": [0, 3], "ani": [0, 6, 8, 11], "These": [0, 2, 5, 6, 7, 8, 11, 12], "record": 0, "retak": 0, "updat": [0, 5, 7, 8], "version": [0, 3, 4, 8, 11], "after": [0, 1, 2, 4, 6, 7, 8, 11], "taken": 0, "further": [0, 1, 5, 6, 8, 11], "state": 0, "blockrv": 0, "0x560137d34c60": 0, "realiz": 0, "space": [0, 5, 6], "specif": [0, 1, 2, 5, 6, 7, 8, 11], "initi": [0, 2, 5, 8, 10, 11], "intuit": 0, "exactli": [0, 11], "Of": [0, 2, 7, 8], "cours": [0, 2, 3, 7, 8, 12], "question": [0, 2, 7, 8], "ask": [0, 2, 8], "best": [0, 1, 6, 7, 11], "algorithm": 0, "done": [0, 1, 7, 8], "straightforward": 0, "repetit": 0, "benchmark": [0, 8], "book": 0, "histori": 0, "random_search": 0, "num_trial": 0, "5": [0, 1, 5, 8, 11], "best_result": 0, "best_sch": 0, "rang": [0, 2, 5, 8, 11], "result": [0, 2, 4, 5, 6, 7, 9, 11], "attempt": [0, 2, 4, 8], "d": [0, 6], "3": [0, 2, 4, 6], "142": 0, "1": [0, 2, 3, 5, 6, 8, 9], "913": 0, "041": 0, "629": 0, "491": 0, "goe": 0, "few": [0, 1, 2, 4, 8], "five": 0, "trial": 0, "smarter": 0, "also": [0, 1, 2, 5, 6, 7, 8, 11], "provid": [0, 1, 3, 5, 7, 8, 10, 11], "util": [0, 1, 2, 5, 6, 8], "remot": 0, "devic": [0, 2, 4, 7], "interest": [0, 2, 6, 7, 8, 10], "meta": [0, 2, 6], "capabl": 0, "meta_schedul": [0, 4], "namespac": 0, "support": [0, 2, 3, 4, 5, 6, 7, 12], "behind": [0, 2, 8], "scene": 0, "parallel": [0, 1, 4, 8, 10], "across": [0, 4], "avoid": [0, 8], "evolutionari": 0, "despit": 0, "magic": 0, "kei": [0, 2, 3, 8, 10, 12], "idea": [0, 2, 8], "good": [0, 2, 6, 7, 10, 11], "tune_tir": [0, 4], "help": [0, 1, 2, 4, 5, 6, 7, 8, 10], "solut": [0, 5, 7, 8], "within": [0, 1, 2, 4], "sch_tune": [0, 4], "num": 0, "core": [0, 4], "config": [0, 4], "tuneconfig": [0, 4], "max_trials_glob": [0, 4], "num_trials_per_it": [0, 4], "space_gener": 0, "schedulefn": 0, "work_dir": [0, 4], "tune_tmp": [0, 4], "task_nam": [0, 4], "2022": [0, 11], "08": 0, "14": [0, 2], "03": [0, 5], "26": [0, 1, 2], "58": 0, "268": 0, "info": 0, "log": [0, 1], "directori": 0, "273": 0, "275": 0, "work": [0, 4, 6, 7], "276": 0, "jsondatabas": 0, "workload": [0, 10, 12], "database_workload": 0, "json": 0, "tune": [0, 4], "database_tuning_record": 0, "308": 0, "localbuild": 0, "max_work": 0, "59": 0, "040": 0, "localrunn": 0, "812": 0, "task": [0, 4, 11], "825": 0, "id": 0, "flop": 0, "weight": [0, 1, 2, 4, 6, 7, 11], "speed": [0, 5], "gflop": [0, 4], "latenc": 0, "termin": 0, "4194304": 0, "total": 0, "827": 0, "27": [0, 5], "05": 0, "032": 0, "send": 0, "builder": [0, 12], "06": 0, "369": 0, "runner": 0, "usr": 0, "share": [0, 2, 3], "miniconda": 0, "env": [0, 1, 2], "python3": [0, 1, 3, 8], "site": 0, "packag": [0, 1, 9, 12], "xgboost": 0, "compat": 0, "py": 0, "36": 0, "futurewarn": 0, "panda": 0, "int64index": 0, "deprec": 0, "remov": [0, 2], "futur": [0, 2, 8], "index": [0, 1, 4, 6, 8, 10, 11], "appropri": 0, "multiindex": 0, "train": [0, 1, 2, 6, 7, 12], "17": [0, 2], "userwarn": 0, "old": 0, "callback": 0, "http": [0, 1, 2, 3, 6, 8], "readthedoc": 0, "io": 0, "en": 0, "python": [0, 1, 2, 5, 7, 8, 10, 11], "warn": [0, 5], "f": [0, 1, 3, 4, 6, 8], "link": 0, "10": [0, 1, 2, 4, 6, 7], "415": 0, "8896": 0, "1451": 0, "5157": 0, "52": 0, "416": 0, "15": 0, "808": 0, "813": 0, "814": 0, "816": 0, "21": 0, "628": 0, "634": 0, "637": 0, "639": 0, "141": 0, "143": 0, "145": 0, "845": 0, "856": 0, "858": 0, "860": 0, "37": [0, 5], "791": 0, "ha": [0, 1, 2, 4, 6], "finish": [0, 4, 11], "818": 0, "save": 0, "xgbmodel": 0, "cost_model": 0, "xgb": 0, "found": 0, "dure": [0, 2, 4, 5, 8, 11], "enter_postproc": 0, "431": 0, "craft": 0, "metaschedul": [0, 4], "its": [0, 1, 2, 7, 8, 12], "own": [0, 2, 6, 7, 8], "built": [0, 6, 7, 8, 10], "broad": 0, "approach": [0, 7, 8, 12], "auto": 0, "system": [0, 3, 5, 7], "line": [0, 1, 6, 8], "under": [0, 2, 6, 7, 8], "hood": [0, 2, 6, 7, 8], "analyz": [0, 8], "data": [0, 1, 2, 4, 5, 6, 8, 11], "propos": 0, "won": [0, 8], "go": [0, 2, 4, 5, 8, 11], "just": [0, 1, 2, 8], "coupl": 0, "analysi": [0, 8], "mechan": [0, 2], "enhanc": 0, "touch": [0, 2, 6, 8], "topic": [0, 4, 7, 12], "983": 0, "987": 0, "989": 0, "990": 0, "999": 0, "38": 0, "694": 0, "39": 0, "374": 0, "392": 0, "393": 0, "55": 0, "779": 0, "28": [0, 1, 2, 6], "077": 0, "31": [0, 2], "336": 0, "19": 0, "4917": 0, "215": 0, "1836": 0, "184": 0, "337": 0, "373": 0, "212": 0, "much": [0, 1, 8], "faster": [0, 8], "than": [0, 6, 8], "glimps": 0, "purpos": [0, 2, 8], "At": 0, "more": [0, 1, 2, 4, 6, 7, 8, 10, 12], "tile": [0, 4], "vector": [0, 1, 4, 5, 7, 10], "intermedi": [0, 2, 4, 5, 6, 7, 8], "unrol": [0, 1, 4], "b1": [0, 2, 6], "block_or_loop": 0, "ann_kei": 0, "tiling_structur": 0, "ann_val": 0, "ssrsr": 0, "v6": 0, "v7": 0, "v8": 0, "l9": 0, "l10": 0, "l11": 0, "l12": 0, "v13": 0, "v14": 0, "v15": 0, "v16": 0, "l17": 0, "l18": 0, "l19": 0, "l20": 0, "v21": 0, "v22": 0, "l23": 0, "l24": 0, "b25": 0, "cache_writ": [0, 4, 5], "write_buffer_index": 0, "storage_scop": [0, 4, 5], "global": [0, 2, 5], "reverse_compute_at": [0, 4, 5, 8, 11], "preserve_unit_loop": 0, "v26": 0, "sample_categor": 0, "candid": 0, "512": 0, "prob": 0, "25": 0, "unroll_explicit": 0, "b27": 0, "unannot": 0, "b28": 0, "b29": 0, "get_child_block": 0, "l30": 0, "l31": 0, "l32": 0, "l33": 0, "l34": 0, "l35": 0, "l36": 0, "l37": 0, "l38": 0, "l39": 0, "l40": 0, "fuse": [0, 1, 4, 6, 8], "l41": 0, "pragma_auto_unroll_max_step": 0, "pragma_unroll_explicit": 0, "l42": 0, "l43": 0, "l44": 0, "l45": 0, "b46": 0, "l47": 0, "l48": 0, "l49": 0, "l50": 0, "l51": 0, "l52": 0, "l53": 0, "b54": 0, "c_global": [0, 5], "alloc_buff": [0, 1, 2, 4, 5, 6, 8, 11], "i_0_j_0_i_1_j_1_fus": 0, "i_2_init": [0, 4], "j_2_init": [0, 4], "i_3_init": 0, "j_3_fused_init": 0, "block_attr": 0, "k_0": [0, 4, 5], "i_2": [0, 4], "j_2": [0, 4], "k_1": [0, 4, 5], "i_3": 0, "j_3_fuse": 0, "ax0": [0, 4, 5, 6, 8, 11], "ax1_fus": 0, "v0": [0, 4, 5], "v1": [0, 4, 5], "allow": [0, 2, 4, 5, 6, 8], "express": [0, 1], "improv": [0, 7, 11], "perspect": [0, 8], "modular": 0, "replac": [0, 2, 8], "implement": [0, 1, 2, 5, 8, 10, 11], "new": [0, 1, 2, 7, 8, 11], "reus": [0, 4, 6], "layer": [0, 1, 2, 7, 8], "mlp": [0, 2, 6], "torch": [0, 1, 2, 6, 10, 11], "torchvis": [0, 1, 2, 6], "test_data": [0, 1, 2, 6], "dataset": [0, 1, 6], "fashionmnist": [0, 1, 2, 12], "fals": [0, 1, 2, 6], "download": [0, 1, 6], "totensor": [0, 1, 2, 6], "test_load": [0, 1, 2, 6], "dataload": [0, 1, 2, 6], "batch_siz": [0, 1, 2, 6], "shuffl": [0, 1, 2, 6], "class_nam": [0, 1, 2, 6], "shirt": [0, 1, 2, 6], "top": [0, 1, 2, 5, 6, 8], "trouser": [0, 1, 2, 6], "pullov": [0, 1, 2, 6], "dress": [0, 1, 2, 6], "coat": [0, 1, 2, 6], "sandal": [0, 1, 2, 6], "sneaker": [0, 1, 2, 6], "bag": [0, 1, 2, 6], "ankl": [0, 1, 2, 6], "boot": [0, 1, 2, 6], "img": [0, 1, 2, 6], "label": [0, 1, 2, 6], "iter": [0, 2, 4, 5, 6, 10], "reshap": [0, 1, 2, 6, 11], "fashion": [0, 1, 2, 6, 7], "mnist": [0, 1, 2, 6], "s3": [0, 2, 6], "websit": [0, 2, 6], "eu": [0, 2, 6], "central": [0, 2, 6], "amazonaw": [0, 2, 6], "com": [0, 1, 2, 6], "imag": [0, 1, 2, 6, 7, 11], "idx3": [0, 2, 6], "ubyt": [0, 2, 6], "gz": [0, 2, 6], "raw": [0, 1, 2, 6], "100": [0, 1, 2, 6], "extract": [0, 2, 6], "idx1": [0, 2, 6], "t10k": [0, 2, 6], "matplotlib": [0, 1, 2, 6], "pyplot": [0, 1, 2, 6], "plt": [0, 1, 2, 6], "figur": [0, 2, 6, 8, 10], "imshow": [0, 1, 2, 6], "colorbar": [0, 2, 6], "pre": [0, 1, 6, 7, 10], "pack": 0, "hide": [0, 1, 2, 6], "wget": [0, 1, 2, 6], "nc": [0, 1, 6], "github": [0, 1, 2, 6], "ai": [0, 1, 2, 3, 6, 7, 8, 12], "web": [0, 1, 2, 6], "fasionmnist_mlp_param": [0, 2, 6], "pkl": [0, 1, 2, 6], "remind": [0, 8], "pickl": [0, 1, 2, 6], "mlp_param": [0, 2, 6], "load": [0, 1, 4, 6], "open": [0, 1, 2, 3, 6, 7, 8], "rb": [0, 1, 2, 6], "data_nd": [0, 2, 6], "784": [0, 1, 2, 6], "nd_param": [0, 2], "v": [0, 2, 4], "item": [0, 1, 2], "mixtur": [0, 2, 10], "where": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "compon": [0, 7], "linear0": [0, 2, 6], "mymodulemixtur": [0, 2], "x": [0, 1, 2, 4, 6], "w": [0, 1, 2, 5, 6, 11], "z": [0, 2], "y": [0, 2, 4, 6, 8, 11], "ss": [0, 1, 2, 5, 6, 8, 11], "w0": [0, 1, 2, 6], "w1": [0, 2, 6], "dataflow": [0, 1, 6], "lv0": [0, 1, 2], "call_tir": [0, 1, 6], "lv1": [0, 2, 6], "relu": [0, 1, 2, 6, 7, 8, 10, 11], "linear": [0, 1, 2, 6, 7, 8, 10], "register_func": [0, 1, 2], "overrid": [0, 1, 2], "torch_linear": [0, 1, 2], "ndarrai": [0, 1, 2, 5, 8, 11], "x_torch": [0, 1, 2], "from_dlpack": [0, 1, 2], "w_torch": [0, 1, 2], "b_torch": [0, 1, 2], "out_torch": [0, 1, 2], "mm": [0, 1, 2, 8], "lnumpy_relu": [0, 2], "maximum": [0, 2, 8], "bind": [0, 4, 12], "correct": [0, 1, 5, 8], "predict": [0, 1, 2, 6, 7, 10], "mymodulewithparam": [0, 2], "bindparam": [0, 2], "ex": [0, 2, 6], "vm": [0, 1, 2, 6], "virtualmachin": [0, 1, 2, 6], "nd_re": [0, 2, 6], "pred_kind": [0, 2, 6], "argmax": [0, 1, 2, 6], "befor": [0, 2, 8, 11], "becaus": [0, 2, 4, 8], "small": [0, 4, 11], "fluctuat": 0, "between": [0, 8, 10], "overal": [0, 2, 4, 5, 6, 7, 8], "magnitud": 0, "ftimer": 0, "g": [0, 2, 7, 8, 10, 11], "242593": 0, "readi": [0, 2, 8], "summar": [0, 8], "diagram": 0, "mod_linear": 0, "from_expr": 0, "with_attr": [0, 8], "sch_tuned_linear": 0, "41": [0, 2], "780": 0, "786": 0, "873": 0, "42": 0, "530": 0, "43": 0, "187": 0, "200832": 0, "213": 0, "29": 0, "322": 0, "834": [0, 11], "7": 0, "3751": 0, "2310": 0, "231": 0, "837": 0, "877": 0, "global_var": 0, "pointer": 0, "insid": [0, 1, 5, 6, 7], "update_func": 0, "mymodulewithparams2": 0, "new_func": 0, "gv": [0, 1, 6], "get_global_var": 0, "ndim": [0, 2, 6], "relai": [0, 2, 6], "constant": [0, 2, 6], "i_0": [0, 4, 5, 11], "i_1": [0, 4, 5, 11], "y_init": [0, 8, 11], "196": 0, "y_updat": [0, 8, 11], "ax1": [0, 4, 5, 6], "been": [0, 1, 4, 6, 7], "again": [0, 1, 2, 6, 8], "amount": [0, 1, 7], "reduct": [0, 1, 5, 8, 11], "mainli": [0, 2, 8], "thank": 0, "50": 0, "155424": 0, "notic": [0, 2, 7, 8], "focus": [0, 5, 8], "start": [0, 1, 2, 4, 5, 7, 8, 12], "focu": [0, 1, 2, 6, 8, 11], "possibli": [0, 2], "without": [0, 2], "nail": 0, "down": [0, 7], "importantli": [0, 4, 7, 8, 10], "flow": [0, 2, 4, 5, 6, 7, 8], "matter": [0, 7], "inform": [0, 10], "below": [0, 1, 2, 4, 8, 10], "lectur": [0, 1, 2, 5, 6, 7, 8, 11], "introduc": [0, 1, 2, 3, 4, 6, 8, 11], "kind": [0, 2, 4, 6, 7, 12], "compos": [0, 1, 6], "togeth": [0, 1, 2, 4, 5, 6, 7, 8], "deploy": [0, 6, 7, 8, 10, 12], "ones": [0, 10], "familiar": [1, 2, 7], "manipul": 1, "classif": [1, 7], "command": [1, 3, 8], "instal": [1, 9, 12], "pip": [1, 3, 8], "nightli": [1, 3, 8], "wheel": [1, 3, 8], "torchaudio": 1, "torchsummari": 1, "extra": [1, 9], "url": 1, "org": 1, "whl": 1, "nn": [1, 6, 11], "function": [1, 3, 5, 7, 9, 11, 12], "test": [1, 4, 5, 8, 11], "topi": [1, 6], "te": [1, 6, 8], "accept": 1, "batch": 1, "through": [1, 2, 5, 7, 8, 10, 12], "convolut": [1, 4], "activ": [1, 2, 7, 8, 12], "pool": 1, "fulli": 1, "order": [1, 2, 6, 8, 10], "input_shap": [1, 6], "nchw": [1, 11], "layout": [1, 5, 11], "pytorch_model": 1, "list": [1, 2, 6], "append": [1, 6], "conv2d": [1, 11], "in_channel": 1, "out_channel": 1, "kernel_s": 1, "bia": [1, 6], "maxpool2d": 1, "flatten": [1, 7], "in_featur": 1, "5408": 1, "out_featur": 1, "softmax": [1, 2, 10], "dim": 1, "sequenti": [1, 10], "name_map": 1, "conv2d_weight": 1, "conv2d_bia": 1, "linear0_weight": 1, "linear0_bia": 1, "6": 1, "linear1_weight": 1, "linear1_bia": 1, "param": [1, 6], "named_paramet": 1, "from_numpi": [1, 6], "weight_map": 1, "map": [1, 4, 5, 7, 8, 10], "fasionmnist_mlp_assignment_param": 1, "accuraci": 1, "84": 1, "file": 1, "around": [1, 2, 3, 8], "83": 1, "eval": 1, "test_loss": 1, "no_grad": 1, "print_img": 1, "sum": [1, 3, 6, 8], "loss": 1, "nll_loss": 1, "max": [1, 2, 6, 8, 11], "probabl": 1, "pred": 1, "keepdim": 1, "format": [1, 2, 6], "eq": 1, "view_a": 1, "len": [1, 6], "ntest": 1, "averag": 1, "4f": 1, "0f": 1, "npimg": 1, "transpos": [1, 6], "hard": [1, 2], "manual": [1, 2, 4, 8, 11], "experienc": 1, "exercis": [1, 2, 9, 12], "primit": [1, 2, 5, 6, 8, 9, 11, 12], "tensor": [1, 2, 3, 7, 11, 12], "requir": [1, 8], "massiv": [1, 4], "engin": [1, 7], "effort": [1, 7], "moreov": 1, "error": [1, 8], "prone": 1, "imagin": 1, "dozen": 1, "exist": [1, 6, 7, 8, 12], "tini": [1, 7], "bug": 1, "your": [1, 8, 11], "could": [1, 2, 7, 10], "annoi": 1, "fortun": 1, "simpler": 1, "blockbuild": 1, "construct": [1, 5, 6, 8, 12], "recal": [1, 2], "design": [1, 2], "And": [1, 6, 8, 11], "stand": 1, "emit_t": [1, 6], "convert": [1, 2], "descript": [1, 5, 7], "which": [1, 2, 3, 4, 5, 6, 7, 8, 10, 11], "wa": 1, "well": [1, 2, 4, 7], "less": 1, "mistak": 1, "signatur": [1, 6, 8], "func": [1, 6, 11], "emit_te_exampl": 1, "instanc": [1, 2, 8], "bb": [1, 5, 6], "dimension": [1, 4, 5, 8, 10], "128x128": 1, "serv": [1, 2, 7, 12], "contain": [1, 2, 4, 5, 6, 7, 8, 10, 12], "got": 1, "shape": [1, 2, 6, 7, 8], "fcomput": [1, 6, 8], "lambda": [1, 6, 8], "dyntensortyp": [1, 6], "emit_output": [1, 6], "emit_func_output": [1, 6], "languag": [1, 2, 6, 7, 8, 10, 11], "equival": [1, 2, 7, 8], "yourself": 1, "short": 1, "inventori": 1, "wrap": 1, "variou": 1, "encourag": [1, 4], "document": 1, "check": [1, 2, 8, 11], "easili": [1, 5], "should": [1, 2, 8, 10, 11], "reflect": 1, "create_model_via_emit_t": 1, "const": [1, 6], "todo": [1, 11], "build_mod": 1, "exec": 1, "dev": [1, 4], "check_equival": 1, "torch_model": 1, "rt_mod": [1, 4], "output_from_pytorch": 1, "output_from_relax": 1, "assert_allclos": [1, 5, 8, 11], "rtol": [1, 5, 8, 11], "1e": [1, 5, 8, 11], "talk": [1, 2, 7, 8, 10], "integr": [1, 7, 12], "regist": [1, 5], "extern": [1, 2, 5, 8], "runtim": [1, 7, 8, 12], "matmul": [1, 5, 6, 8], "mymodulewithexterncal": [1, 2], "pleas": [1, 11], "occur": 1, "emit": [1, 6], "directli": [1, 2, 6, 8, 11], "create_model_with_torch_func": 1, "similar": [1, 2, 6], "program": [1, 2, 3, 5, 12], "challeng": [1, 7, 11, 12], "compute_inlin": 1, "inlin": [1, 5], "memori": [1, 2, 3, 7, 8, 12], "usag": [1, 7], "opposit": 1, "ax": [1, 4], "increas": [1, 4, 7], "before_inlin": 1, "handl": [1, 2, 5, 8], "match_buff": [1, 5], "schedul": [1, 2, 4, 5, 8, 11, 12], "before_fus": 1, "But": [1, 2, 11], "NOT": 1, "standard": [1, 2, 7, 8, 11], "answer": [1, 2, 7, 8], "sever": [1, 7, 10], "reason": [1, 2, 7, 8], "perform": [1, 2, 4, 5, 6, 8, 10, 11, 12], "vari": 1, "accord": [1, 11], "describ": [1, 2, 6, 8], "along": [1, 7], "calcul": 1, "separ": [1, 8], "target_func": 1, "rxplacehold": [1, 6], "rxplaceholder_1": [1, 6], "conv2d_nchw": 1, "i0_0_i1_0_i2_0_i3_0_fus": 1, "2704": 1, "i0_1_i1_1_fused_init": 1, "i2_1_i3_1_fused_init": 1, "conv2d_nchw_init": 1, "1352": 1, "ff": 1, "169": 1, "yy": 1, "13": 1, "xx": 1, "i4": 1, "i5": 1, "i6": 1, "i0_1_i1_1_fus": 1, "i2_1_i3_1_fus": 1, "conv2d_nchw_upd": 1, "rc": 1, "ry": 1, "rx": 1, "rrr": 1, "unlik": 1, "therefor": 1, "concret": [1, 2], "shown": [1, 2, 7, 8, 10], "your_block_nam": 1, "your_function_nam": 1, "pad": [1, 11], "decompos": [1, 5, 11], "transform": [2, 3, 4, 6, 7, 9, 10, 12], "thing": [2, 5, 6, 7, 8, 12], "aim": [2, 7, 8, 11], "repres": [2, 6, 7, 8, 10, 12], "plot": 2, "neural": [2, 7, 8], "network": [2, 7, 8], "consist": [2, 6], "score": 2, "un": 2, "normal": [2, 6], "still": [2, 4, 5, 7, 8], "numpy_mlp": 2, "lv2": [2, 6], "24": 2, "727776": 2, "48": 2, "103207": 2, "404111": 2, "22941603": 2, "354328": 2, "2636428": 2, "516378": 2, "34": 2, "78523": 2, "356462": 2, "73509": 2, "pov": 2, "illustr": [2, 8], "low": [2, 4, 5, 8, 10, 11], "demonstr": [2, 8], "alwai": [2, 8, 11], "explicitli": [2, 8], "alloc": [2, 6, 8], "lnumpy_linear0": 2, "lnumpy_relu0": 2, "lnumpy_linear1": 2, "lnumpy_mlp": 2, "With": [2, 7, 8], "relu0": 2, "linear1": [2, 6], "saw": 2, "walk": [2, 8], "alreadi": [2, 8], "usual": [2, 4, 5, 6, 7, 8, 10], "visual": [2, 8], "box": [2, 7], "arrow": 2, "seen": [2, 7, 8], "earlier": 2, "itself": [2, 7, 8], "commonli": [2, 4, 8], "known": [2, 8], "machin": [2, 3, 5, 7, 8, 10], "framework": [2, 3, 4, 7, 8, 10, 12], "bring": [2, 4, 5, 6, 7, 8, 12], "explain": 2, "lnumpy_call_tir": 2, "popul": [2, 12], "optim": [2, 3, 7, 8, 10, 12], "choos": [2, 10], "ahead": [2, 8], "why": [2, 12], "convent": [2, 8], "low_level_prim_func": 2, "in0": 2, "in1": 2, "destin": 2, "outsid": [2, 6], "higher": [2, 6, 8], "present": 2, "whose": 2, "nevertheless": [2, 7, 8], "common": [2, 4, 7, 8, 11, 12], "assembl": [2, 7], "certainli": [2, 8], "fail": 2, "fit": 2, "simpli": [2, 7], "lost": 2, "nice": 2, "properti": [2, 5, 10], "edg": [2, 6], "outgo": 2, "arbitrarili": 2, "topolog": [2, 6], "definit": [2, 11], "complic": [2, 4], "associ": [2, 7], "back": [2, 8, 11, 12], "insight": 2, "explicit": [2, 8], "formal": [2, 8], "term": [2, 7, 8], "pure": 2, "free": [2, 8], "increment": [2, 6, 8], "counter": 2, "expos": 2, "rewrit": [2, 8], "lnumpy_mlp_with_call_tir": 2, "calltir": 2, "lowest": 2, "continu": [2, 8], "actual": 2, "scope": [2, 3, 4, 6], "had": 2, "ideal": 2, "mark": [2, 6, 8], "region": [2, 4, 5, 8], "gv0": 2, "gv1": 2, "alloc_tensor": 2, "deal": 2, "gone": [2, 8], "compil": [2, 3, 5, 6, 8, 10], "concept": [2, 4, 7, 8], "encount": [2, 8], "later": [2, 7, 8], "enabl": [2, 5, 7, 8], "develop": [2, 3, 6, 7, 8, 12], "though": 2, "virtual": 2, "executor": 2, "addition": [2, 5, 12], "second": [2, 8], "argument": [2, 6, 8], "indic": [2, 4, 5, 6, 7, 8, 11], "727774": 2, "103214": 2, "404115": 2, "2294193": 2, "26364017": 2, "785225": 2, "356468": 2, "735096": 2, "both": [2, 4, 7, 12], "expect": [2, 5, 6, 7, 8], "zero": [2, 4], "copi": [2, 5, 8], "convers": 2, "dlpack": 2, "exchang": 2, "particular": [2, 3, 4, 7, 8, 10], "piggyback": 2, "pytorch": [2, 7, 12], "world": [2, 5, 7, 8, 12], "redirect": [2, 5], "onto": [2, 4, 6, 7], "cudnn": 2, "realiti": 2, "verifi": [2, 8], "dispatch": 2, "sometim": [2, 6, 10], "rest": 2, "valid": [2, 8, 11], "attach": 2, "match": [2, 5], "implicit": 2, "dictionari": 2, "store": [2, 4, 6, 8], "invok": [2, 7], "theme": [2, 5, 7, 12], "invoc": 2, "stage": [2, 4, 5, 6, 7, 8], "e": [2, 7, 8, 10, 11], "taught": 2, "spend": 2, "think": [2, 7], "hand": [2, 7, 10], "hundr": 2, "infeas": 2, "peek": 2, "interact": [2, 5, 9], "episod": 2, "programmat": [2, 6, 8], "stitch": 2, "emb": 2, "ongo": [3, 12], "sourc": [3, 5, 7, 8], "notebook": 3, "cuda": [3, 4], "11": 3, "cu110": 3, "prepar": [3, 12], "architectur": [3, 7], "thread": [3, 5, 8], "window": [3, 11], "platform": [3, 7, 8], "matrix": [3, 5, 6, 8], "local": [3, 6, 7], "leverag": [3, 7, 8, 10, 12], "automat": [3, 7, 12], "summari": [3, 9, 12], "special": [3, 4, 7, 8, 10], "trend": [3, 7], "blockiz": 3, "discuss": [3, 4, 7, 9, 12], "terminologi": 4, "appli": [4, 6, 7, 8], "typic": [4, 7, 8, 10], "collect": [4, 6, 7, 8], "stream": 4, "multi": [4, 5, 8, 10], "processor": [4, 5], "execut": [4, 5, 6, 7, 8, 10, 11, 12], "concurr": 4, "multiprocessor": 4, "wise": 4, "mymodulevecadd": 4, "1024": [4, 5], "i0": [4, 5, 6, 8, 11], "i1": [4, 5, 6, 8, 11], "parameter": 4, "threadidx": 4, "blockidx": 4, "dimens": [4, 6, 8], "thread_bind": 4, "uniform": 4, "move": [4, 8], "forward": [4, 6], "basic": [4, 5, 8], "predefin": 4, "slide": 4, "over": [4, 5, 6, 8, 12], "neighbor": 4, "mymodulewindowsum": 4, "1027": 4, "nthread": 4, "opportun": [4, 5, 6, 7], "rememb": 4, "cache_read": [4, 5], "segment": 4, "green": 4, "a_shar": 4, "read_buffer_index": 4, "compute_at": [4, 5, 11], "130": 4, "inner": [4, 8], "fetch": [4, 6, 8], "techniqu": [4, 7, 12], "cooper": 4, "ax0_0": 4, "ax0_1": 4, "host": 4, "driver": 4, "kernel": [4, 5], "quick": [4, 8], "notabl": [4, 6, 7, 8, 10, 11], "compact": [4, 7], "minimum": 4, "imported_modul": 4, "get_sourc": 4, "metal": [4, 7], "model": [4, 5, 7, 10, 11, 12], "someth": [4, 7, 11], "slightli": [4, 8], "mymodulematmul": 4, "stripe": 4, "onc": [4, 6], "pressur": 4, "tile_local_i": 4, "tile_local_x": 4, "tile_block_i": 4, "tile_block_x": 4, "tile_k": 4, "c_local": 4, "i2": [4, 6, 8], "j0": [4, 5, 8], "j1": [4, 5, 8], "j2": 4, "k0": [4, 5, 11], "k1": [4, 5, 11], "256": 4, "num_flop": 4, "gemm": 4, "1e9": 4, "consid": 4, "sit": 4, "piec": [4, 8], "cache_read_and_coop_fetch": 4, "read_idx": 4, "read_loc": 4, "read_cach": 4, "inner0": 4, "inner1": 4, "_": 4, "tx": 4, "vec": 4, "blocking_with_shar": 4, "b_share": 4, "i_1_j_1_fus": 4, "ax0_ax1_fused_0": 4, "ax0_ax1_fused_1": 4, "ax0_ax1_fused_2": 4, "min": 4, "nvidia": 4, "tesla": 4, "p100": 4, "studi": [4, 5, 6, 9, 11, 12], "acceler": [4, 5, 7, 8, 12], "bridg": 4, "toward": [4, 5, 11], "visit": [4, 10], "incom": 4, "hierarchi": [4, 5], "gpu": [5, 7, 12], "conceptu": 5, "backend": 5, "landscap": 5, "emerg": [5, 7, 12], "recent": 5, "tradition": 5, "scalar": 5, "float": 5, "instruct": [5, 7, 8, 11], "avx": 5, "arm": [5, 7], "neon": 5, "complex": [5, 7], "better": [5, 8], "resembl": [5, 8], "accel_fill_zero": 5, "accel_tmm_add": 5, "accel_dma_copi": 5, "reg": 5, "dram": 5, "lnumpy_tmm": 5, "accumul": 5, "c_accumul": 5, "a_reg": 5, "b_reg": 5, "16x16x16": 5, "limit": 5, "effici": [5, 7], "vendor": 5, "confirm": 5, "correctli": 5, "c_tmm": 5, "c_np": [5, 8, 11], "structur": [5, 9], "group": 5, "relev": [5, 8], "matmulblockmodul": 5, "tmm": 5, "16x16": 5, "vi0": 5, "vj0": 5, "vk0": 5, "tmm_init": 5, "vi1": 5, "vj1": 5, "vk1": 5, "closer": [5, 8], "content": [5, 7, 8], "subregion": 5, "span": 5, "sub": 5, "produc": [5, 8], "surround": 5, "variant": [5, 7, 11], "block_mm": 5, "i0_0": 5, "i0_1": [5, 6], "sr": 5, "matmulmodul": 5, "ii": 5, "ji": 5, "ki": 5, "matmul_o": 5, "vi_o": 5, "vj_o": 5, "vk_o": 5, "matmul_init": 5, "vi_i_init": 5, "vj_i_init": 5, "vi_i": 5, "vj_i": 5, "vk_i": 5, "write_back_block": 5, "a_global_a_reg": 5, "b_global_b_reg": 5, "c_global_accumul": 5, "a_glob": 5, "b_global": 5, "tag": 5, "intrins": 5, "tensorintrin": 5, "tmm16_desc": 5, "offset_factor": 5, "vii": 5, "vjj": 5, "vkk": 5, "tmm16_impl": 5, "sa": 5, "int32": 5, "sb": 5, "sc": 5, "stride": [5, 11], "call_extern": 5, "tmm16": 5, "access_ptr": 5, "matmul_o_init": 5, "matmul_o_upd": 5, "a_1": 5, "b_1": 5, "c_1": 5, "tvm_access_ptr": 5, "type_annot": 5, "elem_offset": 5, "downstream": 5, "micro": 5, "embed": [5, 7, 8], "assembli": [5, 7, 10], "tmm_kernel": 5, "cc_code": 5, "int": 5, "cc": 5, "aa": 5, "stride_a": 5, "stride_b": 5, "stride_c": 5, "contrib": 5, "clang": 5, "temp": [5, 6], "tempdir": 5, "ll_path": 5, "relpath": 5, "ll": 5, "ll_code": 5, "create_llvm": 5, "pragma_import_llvm": 5, "custom": [5, 6, 7], "workspac": 5, "src": 5, "target_info": 5, "45": 5, "memoryinfo": 5, "undefin": 5, "section": [5, 6, 7, 9, 10], "alongsid": 5, "foundat": 5, "constraint": 5, "don": [5, 8], "enough": [5, 11], "option": [5, 11], "ml": [6, 12], "fx": 6, "larger": [6, 12], "tool": [6, 7, 8], "domain": [6, 8], "placehold": [6, 8], "object": [6, 8], "sequenc": [6, 7, 8, 10, 12], "output_shap": [6, 8], "given": [6, 8, 11], "te_matmul": 6, "assert": 6, "reduce_axi": [6, 8], "create_prim_func": [6, 8], "te_relu": 6, "x1": 6, "y1": 6, "x2": 6, "20": 6, "y2": 6, "i1_1": 6, "skip": [6, 8], "caus": 6, "caller": 6, "recommend": [6, 7], "advanc": 6, "fusion": 6, "end": [6, 7, 8, 12], "lv": 6, "put": [6, 12], "belong": [6, 7], "dataflowvar": 6, "isinst": 6, "node": [6, 7], "emiss": 6, "fly": 6, "obtain": [6, 7, 8], "nativ": [6, 7, 8], "mymodel": 6, "__init__": 6, "self": [6, 8], "super": 6, "randn": 6, "trace": 6, "fx_modul": 6, "symbolic_trac": 6, "graph_modul": 6, "__new__": 6, "graphmoduleimpl": 6, "tabular": 6, "print_tabular": 6, "opcod": 6, "arg": 6, "kwarg": 6, "get_attr": 6, "call_funct": 6, "method": [6, 7], "0x7f637e06c980": 6, "logic": 6, "node_map": 6, "map_param": 6, "fetch_attr": 6, "fx_mod": 6, "str": 6, "target_atom": 6, "attr_itr": 6, "atom": 6, "enumer": 6, "hasattr": 6, "rais": 6, "runtimeerror": 6, "referenc": 6, "nonexist": 6, "join": 6, "getattr": 6, "from_fx": 6, "call_function_map": 6, "call_module_map": 6, "input_index": 6, "named_modul": 6, "fn_input": 6, "fn_output": 6, "op": 6, "input_var": 6, "elif": 6, "call_modul": 6, "suppli": 6, "rule": 6, "map_matmul": 6, "map_relu": 6, "mlp_model": 6, "torch_r": 6, "detach": 6, "dens": 6, "broadcast": 6, "map_nn_linear": 6, "nn_mod": 6, "map_nn_relu": 6, "mlpmodul": 6, "t_add": 6, "lv3": 6, "dense1": 6, "lv4": 6, "add1": 6, "t_matmul_nt": 6, "layout_free_buff": 6, "map_nn_relu_op": 6, "map_nn_linear_op": 6, "mlpmodulehighlevel": 6, "either": [6, 8], "builtin": 6, "avail": 6, "cannot": [6, 10], "combin": [6, 8, 12], "tradeoff": 6, "briefli": 6, "upon": 6, "applic": [7, 12], "undoubtedli": 7, "becom": [7, 12], "ubiquit": [7, 12], "smart": 7, "home": 7, "power": [7, 8], "speech": 7, "recognit": 7, "vision": 7, "backbon": 7, "autonom": 7, "discov": 7, "explor": 7, "rich": 7, "app": 7, "quit": 7, "fun": 7, "deploi": [7, 8, 12], "cloud": 7, "compani": 7, "servic": 7, "pop": 7, "head": 7, "vehicl": 7, "intellig": 7, "phone": [7, 8], "recogn": 7, "flower": 7, "garden": 7, "tend": 7, "iot": 7, "sensor": 7, "chip": 7, "drill": 7, "even": [7, 8], "greater": 7, "divers": 7, "categori": 7, "x86": 7, "heavi": 7, "lift": 7, "phase": 7, "product": [7, 12], "extend": 7, "non": 7, "relat": [7, 8, 10], "infer": [7, 12], "themselv": [7, 10], "user": 7, "privaci": 7, "protect": 7, "scale": [7, 12], "distribut": 7, "cluster": 7, "scenario": 7, "productionis": 7, "gap": 7, "facilit": [7, 10], "commun": 7, "appear": [7, 11], "written": 7, "tensorflow": 7, "jax": 7, "routin": 7, "manag": 7, "resourc": 7, "interfac": 7, "java": 7, "android": [7, 8], "analogi": 7, "tradit": 7, "necessarili": 7, "translat": [7, 11, 12], "That": 7, "worthwhil": 7, "independ": [7, 8, 10], "minim": [7, 12], "camera": 7, "classifi": 7, "tabl": 7, "lookup": 7, "nlp": 7, "abil": [7, 8, 10], "especi": 7, "tensorcor": 7, "strict": 7, "boundari": 7, "pair": 7, "stabl": 7, "fact": [7, 8], "collabor": 7, "background": 7, "grow": 7, "scientist": 7, "teach": 7, "methodologi": 7, "who": 7, "wild": 7, "bread": 7, "butter": 7, "solv": [7, 12], "problem": [7, 12], "principl": [7, 8], "experi": 7, "depth": 7, "hidden": 7, "incorpor": [7, 10], "novel": 7, "push": 7, "rational": 7, "my": 7, "isn": 7, "fast": [7, 8], "softwar": 7, "stack": 7, "isol": 7, "plai": 7, "increasingli": 7, "role": 7, "ecosystem": 7, "modern": [7, 8], "bare": 7, "realli": 7, "dive": 7, "pixel": 7, "project": 7, "length": [7, 8, 10], "200": 7, "foremost": 7, "multidimension": 7, "knowledg": 7, "encod": 7, "entir": 7, "fold": 7, "linear_relu": 7, "left": 7, "right": [7, 10], "nest": [7, 8, 10], "represent": 7, "denot": 7, "perhap": 7, "keyword": 7, "interpret": [7, 8], "todai": 8, "recap": [8, 12], "apach": 8, "explan": 8, "motiv": 8, "matric": 8, "y_": [8, 11], "sum_k": [8, 11], "a_": [8, 11], "b_": [8, 11], "c_": [8, 11], "mathbb": [8, 11], "c_mm_relu": 8, "openbla": 8, "lower": 8, "restrict": 8, "subset": 8, "arithmet": 8, "primarili": 8, "lnumpy_mm_relu": 8, "mm_relu": 8, "storag": 8, "revisit": 8, "tutori": [8, 12], "slower": 8, "statement": [8, 10], "dialect": 8, "ast": 8, "direct": 8, "similarli": 8, "syntact": 8, "coresspond": 8, "plain": 8, "declar": 8, "syntax": 8, "block_axi": 8, "axis_typ": 8, "axis_rang": 8, "mapped_valu": 8, "suppos": 8, "impli": 8, "strictli": 8, "speak": 8, "fix": 8, "locat": 8, "crucial": 8, "carri": [8, 10], "127": 8, "wrong": 8, "due": [8, 11], "mismatch": 8, "strategi": 8, "situat": 8, "outer": 8, "range_of_i": 8, "range_of_j": 8, "range_of_k": 8, "mymodulewithaxisremapsugar": 8, "overlap": 8, "feel": 8, "safe": [8, 10], "affect": 8, "hold": 8, "primfunc": 8, "mymodulewithtwofunct": 8, "temporari": 8, "went": 8, "journei": 8, "ingredi": 8, "lnumpy_mm_relu_v2": [8, 11], "variat": 8, "edit": 8, "pragmat": [8, 10], "ourselv": 8, "block_i": 8, "procedur": [8, 10], "accident": 8, "twice": 8, "longer": 8, "kept": 8, "conveni": 8, "sync": 8, "implicitli": 8, "lnumpy_mm_relu_v3": 8, "takeawai": 8, "paradigm": 8, "auxiliari": 8, "runnabl": 8, "intel": 8, "skylak": 8, "adjust": 8, "accordingli": 8, "rt_lib": [8, 11], "func_mm_relu": 8, "rt_lib_aft": 8, "sec": 8, "0034797": 8, "00124186": 8, "uniformli": 8, "behavior": 8, "lead": 8, "tast": 8, "mod_transform": 8, "rt_lib_transform": 8, "f_timer_transform": 8, "000684622": 8, "certain": 8, "shorten": 8, "middl": 8, "feed": 8, "debug": 8, "bake": 8, "ij": 8, "ik": 8, "kj": 8, "te_func": 8, "mymodulefromt": 8, "repeat": 8, "veri": 8, "simplifi": 8, "equal": 8, "lot": 8, "expertis": 8, "prelud": [9, 12], "introductori": 10, "overview": 10, "pseudo": 10, "f32x4": 10, "arbitrari": 10, "luckili": 10, "handi": 10, "know": 10, "long": 10, "arang": 11, "o": 11, "utput": 11, "conv": 11, "lnumpy_add": 11, "c_lnumpi": 11, "int64": 11, "myadd": 11, "a_tvm": 11, "b_tvm": 11, "c_tvm": 11, "12": 11, "mathemat": 11, "sum_": 11, "di": 11, "dj": 11, "q": 11, "channel": 11, "hight": 11, "width": 11, "filter": 11, "ci": 11, "h": 11, "co": 11, "out_h": 11, "out_w": 11, "data_torch": 11, "weight_torch": 11, "conv_torch": 11, "474": 11, "510": 11, "546": 11, "582": 11, "618": 11, "654": 11, "762": 11, "798": 11, "870": 11, "906": 11, "942": 11, "1050": 11, "1086": 11, "1122": 11, "1158": 11, "1194": 11, "1230": 11, "1338": 11, "1374": 11, "1410": 11, "1446": 11, "1482": 11, "1518": 11, "1626": 11, "1662": 11, "1698": 11, "1734": 11, "1770": 11, "1806": 11, "1914": 11, "1950": 11, "1986": 11, "2058": 11, "2094": 11, "1203": 11, "1320": 11, "1437": 11, "1554": 11, "1671": 11, "1788": 11, "2139": 11, "2256": 11, "2373": 11, "2490": 11, "2607": 11, "2724": 11, "3075": 11, "3192": 11, "3309": 11, "3426": 11, "3543": 11, "3660": 11, "4011": 11, "4128": 11, "4245": 11, "4362": 11, "4479": 11, "4596": 11, "4947": 11, "5064": 11, "5181": 11, "5298": 11, "5415": 11, "5532": 11, "5883": 11, "6000": 11, "6117": 11, "6234": 11, "6351": 11, "6468": 11, "myconv": 11, "data_tvm": 11, "weight_tvm": 11, "conv_tvm": 11, "bmm_relu": 11, "batched_matmul_relu": 11, "bmm": 11, "lnumpi": 11, "hint": 11, "mybmmrelu": 11, "student": 11, "targetmodul": 11, "i2_0": 11, "ax0_init": 11, "ax1_0": 11, "ax1_1": 11, "i2_1": 11, "sure": 11, "assert_structural_equ": 11, "before_rt_lib": 11, "after_rt_lib": 11, "before_tim": 11, "f_timer": 11, "innov": 12, "daili": 12, "live": 12, "great": 12, "combinatori": 12, "multitud": 12, "broader": 12, "coverag": 12, "footprint": 12, "driven": 12, "search": 12, "comprehens": 12, "treatment": 12, "systemat": 12, "materi": 12, "progress": 12, "introduct": 12, "mix": 12, "stochast": 12, "remark": 12}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"automat": [0, 4], "program": [0, 4, 8, 9, 10, 11], "optim": [0, 4], "prelud": [0, 2, 6, 8], "prepar": [0, 1, 2, 4, 5, 6], "recap": 0, "transform": [0, 1, 5, 8, 11], "primit": [0, 10], "tensor": [0, 5, 6, 8, 9, 10], "function": [0, 2, 4, 6, 8, 10], "trace": 0, "stochast": 0, "schedul": 0, "deep": [0, 6], "dive": [0, 6], "search": 0, "over": 0, "leverag": [0, 4], "default": 0, "autoschedul": 0, "section": [0, 1, 2, 8, 11], "checkpoint": [0, 2, 8], "put": 0, "thing": 0, "back": [0, 6], "end": [0, 1, 2], "model": [0, 1, 2, 6], "execut": [0, 1, 2], "discuss": [0, 2, 5, 6, 8], "summari": [0, 2, 4, 5, 6, 7, 8, 10], "mlc": 1, "assign": 1, "1": [1, 4, 11], "2": [1, 5, 11], "ingest": 1, "from": [1, 6], "pytorch": [1, 6], "3": [1, 11], "us": [1, 6, 8], "vendor": 1, "librari": [1, 2], "4": 1, "load": 2, "dataset": 2, "download": 2, "paramet": [2, 8], "integr": [2, 6], "construct": 2, "an": [2, 6], "irmodul": [2, 6], "tvmscript": [2, 8], "comput": [2, 5, 8], "graph": 2, "view": 2, "call_tir": 2, "dataflow": 2, "block": [2, 4, 5, 6, 8], "build": [2, 4, 6, 8, 11], "run": [2, 4, 8], "exist": 2, "environ": 2, "regist": 2, "runtim": 2, "mix": 2, "tensorir": [2, 4, 5, 6, 8, 11], "code": [2, 4, 5, 8], "bind": [2, 8], "gpu": [3, 4], "hardwar": [3, 5], "acceler": 3, "instal": [3, 8], "packag": [3, 8], "part": [4, 5], "architectur": 4, "thread": 4, "window": 4, "sum": 4, "exampl": [4, 6, 11], "other": 4, "platform": 4, "matrix": 4, "multipl": 4, "local": 4, "share": 4, "memori": [4, 5], "special": 5, "trend": 5, "kei": [5, 7], "element": [5, 7, 11], "A": 5, "loop": [5, 8], "around": 5, "blockiz": 5, "creat": [5, 6, 8], "introduc": 5, "scope": 5, "machin": [6, 12], "learn": [6, 8, 12], "framework": 6, "through": 6, "builder": 6, "express": [6, 8], "creation": 6, "blockbuild": 6, "api": 6, "import": 6, "torchfx": 6, "graphmodul": 6, "map": 6, "come": 6, "fashionmnist": 6, "remark": [6, 7], "translat": 6, "high": 6, "level": 6, "oper": 6, "introduct": 7, "what": 7, "i": 7, "ml": 7, "compil": [7, 12], "why": [7, 8], "studi": [7, 8], "abstract": [7, 8, 9, 10], "implement": 7, "case": 8, "one": 8, "buffer": 8, "For": 8, "iter": 8, "axi": 8, "properti": 8, "extra": [8, 10], "inform": 8, "sugar": 8, "ax": 8, "attribut": 8, "decor": 8, "get": 8, "anoth": 8, "variant": 8, "exercis": [8, 11], "wai": 8, "interact": 8, "via": 8, "gener": 8, "result": 8, "structur": 10, "how": 11, "write": 11, "wise": 11, "add": 11, "broadcast": 11, "2d": 11, "convolut": 11, "parallel": 11, "vector": 11, "unrol": 11, "batch": 11, "matmul": 11, "evalu": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinxcontrib.bibtex": 9, "sphinx.ext.viewcode": 1, "sphinx": 56}})